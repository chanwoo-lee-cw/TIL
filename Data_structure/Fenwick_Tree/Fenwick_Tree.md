# 펜윅 트리

## 펜윅 트리란?

> 배열의 누적합을 부분적으로 저장해서, 구간 합과 값 변경을 둘 다 **O(log N)** 시간에 계산할 수 있게 만든 자료구조
>
> 즉, 펜윅 트리는 비트연산자를 이용한 "구간 합 + 값 변경"을 처리하기 위한 자료 구조이다.



## 원리

해당 인덱스의 **마지막 1비트**를 이용해서 누적합을 구한 구간을 계산한다.

![스크린샷 2025-11-26 오후 11.21.16](/Users/chanwoo/Desktop/스크린샷 2025-11-26 오후 11.21.16.png)

| tree 인덱스 | 비트 패턴(2진수) | 담당 길이 | 저장되는 값(구간 합)          |
| ----------- | ---------------- | --------- | ----------------------------- |
| 1           | `1`              | 1칸       | 1                             |
| 2           | `10`             | 2칸       | 1 + 2                         |
| 3           | `11`             | 1칸       | 3                             |
| 4           | `100`            | 4칸       | 1 + 2 + 3 + 4                 |
| 5           | `101`            | 1칸       | 5                             |
| 6           | `110`            | 2칸       | 5 + 6                         |
| 7           | `111`            | 1칸       | 7                             |
| 8           | `1000`           | 8칸       | 1 + 2 + 3 + 4 + 5 + 6 + 7 + 8 |



## 구간 합, 범위 구하기

```
i & -i : i에서 담당할 길이
```

예시,

```
2 -> 0010
-2 -> 1110

0010
1110
-----
0010
```

즉, 2는 `0010 -> 2` 의 길이의 범위만큼 저장한다

